import pandas as pd
import numpy as np

def resolverEspacios(valor):
    valor = str(valor)
    if valor[0] == ' ':
        valor = valor[1:]
    if valor == '':
        valor = np.nan
    if valor == 'nan':
        valor = np.nan
    return valor

def arreglarAltura(valor):
  valor = str(valor)
  for caracter in valor:
    if caracter == " ":
        valor=valor.replace(caracter,"")
    if not caracter.isnumeric() and caracter != ".":
      valor = valor.replace(caracter,'')
  return valor

def arreglarPeso(valor):
    valor = str(valor)
    for caracter in valor:
        if not caracter.isnumeric() and caracter != ".":
            valor = valor.replace(caracter,'')
    valor = float(valor)
    valor = int(valor)
    return valor

def promedioFloat(valor):
    valor= str(valor)
    for palabra in valor:
        if palabra == " ":
            valor=valor.replace(palabra,"")
    valor = float(valor)
    return valor

def arreglarSexo(valor):
    valor = str(valor)
    valor =valor.lower()
    resultado= ''
    resultado+=valor[0]
    if resultado == "a":
        resultado = np.nan
    elif resultado != "m" and resultado != "h":
        resultado = "nb"
    return resultado

def arreglarLu(valor):
    valor = str(valor)
    i = 0
    for palabra in valor:
        if not palabra.isnumeric():
            if i == 0:
                valor = valor.replace(palabra,'/')
                i=1
            else:
                valor = valor.replace('//','/')
    return valor

def arreglarObservacion(valor):
    valor = str(valor)
    valor =valor.lower()
    if valor != "ninguna":
        if valor == "hipertenso" or valor == "hiper tension":
            valor = "hipertension"
        if valor == "dolor cabeza":
            valor = "dolor de cabeza"
        elif valor != "hipertension":
            valor = "ninguna"

    return valor

csv = pd.read_csv("datos.csv")
csv = csv.applymap(resolverEspacios)
csv.dropna(inplace=True)
csv[' Altura'] = csv[' Altura'].apply(arreglarAltura)
csv[' Peso'] = csv[' Peso'].apply(arreglarPeso)
csv[' Promedio'] = csv[' Promedio'].apply(promedioFloat)
csv[' Sexo'] = csv[' Sexo'].apply(arreglarSexo)
csv[' LU']= csv[' LU'].apply(arreglarLu)
csv[' Observacion']= csv[' Observacion'].apply(arreglarObservacion)
csv.dropna(inplace=True)
print(csv)
